# Lab Work 3: Thread Synchronization (Marker)

Проект представляет собой консольное приложение на C++, демонстрирующее сложную синхронизацию потоков с использованием объектов ядра Windows (Events, Critical Sections). Приложение моделирует работу конкурирующих потоков-маркеров, заполняющих общий массив данных.

## Постановка задачи

Разработать программу, состоящую из основного потока `Main` и нескольких экземпляров потока `Marker`.

### 1. Поток Main (Основной)
Выполняет следующие действия:
1.  Захватывает память под массив целых чисел и инициализирует его нулями.
2.  Запрашивает количество потоков `marker` и запускает их.
3.  Дает сигнал на старт всем потокам одновременно.
4.  **В цикле:**
    *   Ожидает, пока **все** активные потоки `marker` подадут сигнал о невозможности продолжения работы.
    *   Выводит содержимое массива на консоль.
    *   Запрашивает у пользователя порядковый номер потока `marker` для остановки.
    *   Подает сигнал выбранному потоку на завершение и ожидает его полного завершения.
    *   Подает сигнал оставшимся потокам на продолжение работы (`hContinue`).
5.  Завершает работу после остановки всех потоков.

### 2. Поток Marker
Выполняет следующие действия:
1.  Ожидает сигнал на старт от потока `Main`.
2.  Инициализирует генератор случайных чисел уникальным значением.
3.  **Циклически:**
    *   Генерирует случайный индекс массива.
    *   Если элемент массива с этим индексом равен нулю:
        *   Потоку делается задержка **5 миллисекунд**.
        *   В элемент записывается порядковый номер потока.
        *   Потоку делается задержка **5 миллисекунд**.
    *   Если элемент занят:
        *   Выводит информацию на консоль (порядковый номер, количество помеченных элементов, индекс).
        *   Подает сигнал потоку `Main` о невозможности продолжения.
        *   Ожидает ответный сигнал от `Main` (на продолжение или на завершение).
4.  При получении сигнала на завершение: зануляет в массиве все элементы, которые он пометил, и завершается.

---

## Технический стек

*   **Язык:** C++ (Standard: C++17)
*   **Платформа:** Windows (Windows API)
*   **Среда разработки:** Visual Studio 2022
*   **Механизмы синхронизации:**
    *   `CRITICAL_SECTION` — для потокобезопасного вывода в консоль.
    *   `Event` (События) — объекты с ручным (Manual) и автоматическим (Auto) сбросом.
    *   `WaitForMultipleObjects` — для ожидания группы сигналов.

---

## Структура проекта

Решение разделено на модули для удобства поддержки и соблюдения принципа единственной ответственности.

```text
Project Root
├── Src/
│   ├── ArrayManager.*       # Класс для работы с памятью массива и синхронизированного вывода
│   ├── ThreadManager.*      # Класс управления дескрипторами потоков и событий (Events)
│   ├── MarkerLogic.*        # Основная логика работы функции потока-маркера
│   └── MarkerLab.cpp        # Точка входа (main), логика основного цикла
└── MarkerLab.sln            # Файл решения Visual Studio
